var de=Object.defineProperty;var X=s=>{throw TypeError(s)};var ue=(s,e,t)=>e in s?de(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var d=(s,e,t)=>ue(s,typeof e!="symbol"?e+"":e,t),me=(s,e,t)=>e.has(s)||X("Cannot "+t);var g=(s,e,t)=>(me(s,e,"read from private field"),t?t.call(s):e.get(s)),B=(s,e,t)=>e.has(s)?X("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(s):e.set(s,t);import"./disclose-version.Bg9kRutz.js";import{aK as he,i as pe,aV as ve,ab as K,O as Y,V as Z,I as $,ap as _e,ax as ee,aW as te,v as ge,ad as R,j as q,u as W,aI as ke,l as F,q as xe,m as ye,aC as Ce,z as be,p as oe,aN as Ee,f as h,a as ae,d as H,g as i,b as L,e as Be,n as se,s as we}from"./runtime.D2_qJMqH.js";import{c as v,a as p,t as Oe}from"./template.-1lJmaN6.js";import{i as z}from"./if.DQDEx0g4.js";import{e as Me}from"./each.DhYb_c6Z.js";import{s as I}from"./snippet.DPPw8-wN.js";import{c as re}from"./svelte-component.BdD4hKdB.js";import{s as ne}from"./props.DioveIhQ.js";import{o as Ie}from"./utils.Dghph3y9.js";import{p as N}from"./proxy.CdfeBWYI.js";const J=0,D=1,Q=2;function Ne(s,e,t,r,o){F&&xe();var a=s,f=he(),c=ge,u,y,k,C,b=(f?Y:Z)(void 0),x=(f?Y:Z)(void 0),E=!1;function m(n,_){E=!0,_&&($(l),ee(l),te(c));try{n===J&&t&&(y?R(y):y=q(()=>t(a))),n===D&&r&&(k?R(k):k=q(()=>r(a,b))),n===Q&&o&&(C?R(C):C=q(()=>o(a,x))),n!==J&&y&&W(y,()=>y=null),n!==D&&k&&W(k,()=>k=null),n!==Q&&C&&W(C,()=>C=null)}finally{_&&(te(null),ee(null),$(null),ke())}}var l=pe(()=>{if(u!==(u=e())){if(ve(u)){var n=u;E=!1,n.then(_=>{n===u&&(K(b,_),m(D,!0))},_=>{if(n===u)throw K(x,_),m(Q,!0),x.v}),F?t&&(y=q(()=>t(a))):_e(()=>{E||m(J,!0)})}else K(b,u),m(D,!1);return()=>u=null}});F&&(a=ye)}const ie=Symbol("modal");function Pe(s){Ee(ie,s)}function ce(){return Ce(ie)}function Je(s){try{const e=ce();e.onBeforeClose=s}catch{console.error("onBeforeClose must be called inside a component rendered by Modals");return}}function Qe(s){const e=ce();e.exitBeforeEnter=!0;const t=Ie(s,"outroend",()=>{setTimeout(()=>{e.modals.transitioning=!1})});be(()=>()=>{t()})}function Te(s,e){oe(e,!0),Pe(e.modal);var t=v(),r=h(t);I(r,()=>e.children),p(s,t),ae()}var P,S;const V=class V extends EventTarget{constructor(t,{id:r,component:o,props:a}){super();d(this,"_props");d(this,"result",Ae());d(this,"id");d(this,"component");d(this,"modals");B(this,P,H(!1));B(this,S,Be(()=>this.modals.stack.length===0?!1:this.modals.stack[this.modals.stack.length-1].id===this.id&&!this.modals.transitioning));d(this,"close",(...t)=>{var o;if(((o=this.onBeforeClose)==null?void 0:o.call(this))===!1)return!1;const r=t[0];return this.dispatchEvent(new CustomEvent("close",{detail:r})),this.result.resolve(r),!0});d(this,"onBeforeClose");this.id=r||((V._idCounter+=1)-1).toString(),this.component=o,this._props=a??{},this.modals=t}get exitBeforeEnter(){return i(g(this,P))}set exitBeforeEnter(t){L(g(this,P),N(t))}get isOpen(){return i(g(this,S))}get index(){return this.modals.stack.indexOf(this)}get props(){return{...this._props,id:this.id,index:this.index,isOpen:this.isOpen,close:this.close}}get promise(){return this.result.promise}};P=new WeakMap,S=new WeakMap,d(V,"_idCounter",0);let U=V;function Ae(){let s,e;return{promise:new Promise((r,o)=>{s=r,e=o}),resolve:s,reject:e}}var T,A,j;class je{constructor(){B(this,T,H(N([])));B(this,A,H(null));B(this,j,H(!1));d(this,"open",async(e,t,r)=>{var f;if(this.transitioning)return;if(r!=null&&r.replace&&!((f=this.stack[this.stack.length-1])==null?void 0:f.close()))throw new Error("Current modal prevented closing");this.action="push";const o=this.stack[this.stack.length-1];o!=null&&o.exitBeforeEnter&&(this.transitioning=!0);const a=new U(this,{id:r==null?void 0:r.id,component:e,props:t});return this.stack.push(a),a.addEventListener("close",()=>{a.exitBeforeEnter&&(this.transitioning=!0),this.stack.indexOf(a)>-1&&this.stack.splice(this.stack.indexOf(a),1),this.action="pop"},{once:!0}),a.promise});d(this,"close",(e=1)=>{if(typeof e!="number"||e<1)throw new Error(`amount must be a number greater than 0. Received ${e}`);const t=this.stack.slice(this.stack.length-e).reverse();let r=0;for(const o of t){if(!o.close())break;r+=1}return e===r});d(this,"closeById",e=>{const t=this.stack.find(r=>r.id===e);return t?t.close():!1});d(this,"closeAll",()=>this.close(this.stack.length))}get stack(){return i(g(this,T))}set stack(e){L(g(this,T),N(e))}get action(){return i(g(this,A))}set action(e){L(g(this,A),N(e))}get transitioning(){return i(g(this,j))}set transitioning(e){L(g(this,j),N(e))}}T=new WeakMap,A=new WeakMap,j=new WeakMap;const w=new je;var qe=Oe("<!> <!>",1);function Ue(s,e){oe(e,!0);function t(f){return typeof f.prototype>"u"}var r=qe(),o=h(r);z(o,()=>w.stack.length>0,f=>{var c=v(),u=h(c);I(u,()=>e.backdrop??se,()=>w),p(f,c)});var a=we(o,2);Me(a,19,()=>w.stack,f=>f.id,(f,c)=>{Te(f,{get modal(){return i(c)},children:(u,y)=>{var k=v(),C=h(k);z(C,()=>t(i(c).component),b=>{var x=v(),E=h(x);Ne(E,()=>i(c).component(),m=>{var l=v(),n=h(l);I(n,()=>e.loading??se,()=>w),p(m,l)},(m,l)=>{var n=v(),_=h(n);z(_,()=>e.modal,O=>{var M=v(),G=h(M);I(G,()=>e.modal,()=>({component:i(l).default,props:i(c).props}),()=>w),p(O,M)},O=>{var M=v(),G=h(M);re(G,()=>i(l).default,(le,fe)=>{fe(le,ne(()=>i(c).props))}),p(O,M)}),p(m,n)}),p(b,x)},b=>{var x=v(),E=h(x);z(E,()=>e.modal,m=>{var l=v(),n=h(l);I(n,()=>e.modal,()=>({component:i(c).component,props:i(c).props}),()=>w),p(m,l)},m=>{var l=v(),n=h(l);re(n,()=>i(c).component,(_,O)=>{O(_,ne(()=>i(c).props))}),p(m,l)}),p(b,x)}),p(u,k)},$$slots:{default:!0}})}),p(s,r),ae()}export{Ue as M,Qe as e,w as m,Je as o};
