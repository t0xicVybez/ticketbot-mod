import{e as Nt}from"../chunks/index.g5YcAAdQ.js";import"../chunks/disclose-version.Bg9kRutz.js";import{p as ut,f as R,s as d,c as o,aC as Zt,a as mt,r,g as e,t as tt,d as Y,b,e as kt,h as ht}from"../chunks/runtime.D2_qJMqH.js";import{s as pt}from"../chunks/render.DYyZBxIN.js";import{i as T}from"../chunks/if.DQDEx0g4.js";import{e as ft,i as Ct}from"../chunks/each.DhYb_c6Z.js";import{t as V,a as n,c as P,n as q}from"../chunks/template.-1lJmaN6.js";import{r as _t,s as it}from"../chunks/attributes.HKi8Fu_N.js";import{s as wt,t as It}from"../chunks/class.CZ_Lwgno.js";import{k as Jt,j as lt,d as Ut}from"../chunks/utils.Dghph3y9.js";import{R as Mt,b as vt}from"../chunks/Required.0zfnBhzh.js";import{p as U}from"../chunks/proxy.CdfeBWYI.js";import{p as zt}from"../chunks/event-modifiers.BDD76Zze.js";import{s as Bt,a as Ht}from"../chunks/store.B-TJ19st.js";import{p as Ft}from"../chunks/stores.DEmN4aYk.js";import{E as Wt}from"../chunks/ErrorBox.CbGQpU3f.js";import{h as Gt}from"../chunks/html.BiDgUgRj.js";import{p as F}from"../chunks/props.DioveIhQ.js";import{m as Kt}from"../chunks/data.CSunYKlX.js";import{w as Qt,g as Tt}from"../chunks/entry.DD3pBHu9.js";import"../chunks/legacy.CtaTdtmd.js";import{s as $,f as Xt}from"../chunks/index.DF_JIHC5.js";import{c as Yt}from"../chunks/svelte-component.BdD4hKdB.js";import{a as $t,t as St}from"../chunks/transitions.BIDcdJtW.js";import{i as Lt}from"../chunks/lifecycle.J282GXZ8.js";import{a as te,f as ee}from"../chunks/index.Byl_D19b.js";import{o as ae}from"../chunks/index-client.BK-sKD8p.js";import{t as G}from"../chunks/state.svelte.ciRFsZAd.js";async function re({fetch:x,params:t}){var S;const a=await x(`/api/admin/guilds/${t.guild}/tags`),i=(S=a.headers.get("Content-Type"))==null?void 0:S.includes("json"),z=i?await a.json():await a.text();if(!a.ok)Nt(a.status,i?JSON.stringify(z):z);else return{tags:z}}const la=Object.freeze(Object.defineProperty({__proto__:null,load:re},Symbol.toStringTag,{value:"Module"}));var se=V('<p class="text-sm font-medium">Output</p> <div class="block w-full break-words rounded-md bg-blurple/20 p-3 font-mono text-sm shadow-sm dark:bg-blurple/20"><!></div>',1),oe=V('<div><label><span class="font-medium">Name</span> <!> <i class="fa-solid fa-circle-question cursor-help text-gray-500 dark:text-slate-400" title="The tag name - can contain UNICODE emoji (not emoji names)"></i> <input type="text" class="input form-input" required></label></div> <div><label><span class="font-medium">Auto tag regular expression</span> <i class="fa-solid fa-circle-question cursor-help text-gray-500 dark:text-slate-400" title="Optional - regex to trigger this tag"></i> <input type="text" class="input form-input"></label></div> <div><label class="font-medium"><span class="font-medium">Content</span> <!> <i class="fa-solid fa-circle-question cursor-help text-gray-500 dark:text-slate-400" title="The tag content"></i> <textarea class="input form-input h-24" maxlength="1000" required></textarea></label> <!></div>',1);function jt(x,t){ut(t,!0);let a=F(t,"tag",15);var i=oe(),z=R(i),S=o(z),y=d(o(S),2);Mt(y);var c=d(y,4);_t(c),r(S),r(z);var f=d(z,2),L=o(f),j=d(o(L),4);_t(j),r(L),r(f);var _=d(f,2),w=o(_),C=d(o(w),2);Mt(C);var N=d(C,4);Jt(N),r(w);var B=d(w,2);T(B,()=>a().content,l=>{var m=se(),p=d(R(m),2),v=o(p);Gt(v,()=>Kt.parse(a().content.replace(/\n/g,`

`).replace(/{+\s?(user)?name\s?}+/gi,"@"+Zt("user").username))),r(p),n(l,m)}),r(_),vt(c,()=>a().name,l=>a(a().name=l,!0)),vt(j,()=>a().regex,l=>a(a().regex=l,!0)),vt(N,()=>a().content,l=>a(a().content=l,!0)),n(x,i),mt()}function ne(x=[]){const t=Qt(x),{set:a,update:i,subscribe:z}=t;let S={duration:3e3,placement:"bottom-right",type:"info",theme:"dark"};function y(_){const{duration:w=3e3,placement:C="bottom-right",type:N="info",theme:B="dark",...l}={...S,..._},m=Date.now(),p={...l,uid:m,placement:C,type:N,theme:B,duration:w,remove:()=>{i(v=>v.filter(h=>h.uid!==m))},update:v=>{var k;delete v.uid;const h=(k=Tt(t))==null?void 0:k.findIndex(g=>(g==null?void 0:g.uid)===m);h>-1&&i(g=>[...g.slice(0,h),{...g[h],...v},...g.slice(h+1)])}};return i(v=>[...v,p]),w>0&&setTimeout(()=>{p.remove(),typeof p.onRemove=="function"&&p.onRemove()},w),p}function c(_){var w;return(w=Tt(t))==null?void 0:w.find(C=>(C==null?void 0:C.uid)===_)}function f(){a([])}function L(){i(_=>_.slice(0,_.length-1))}function j(_){S={...S,..._}}return{subscribe:z,add:y,success:ct("success",y),info:ct("info",y),error:ct("error",y),warning:ct("warning",y),clearAll:f,clearLast:L,getById:c,setDefaults:j}}const K=ne([]);function ct(x,t){return function(){if(typeof arguments[0]=="object"){const a=arguments[0];return t({...a,type:x})}else if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){const a=arguments[2]||{};return t({...a,type:x,title:arguments[0],description:arguments[1]})}else if(typeof arguments[0]=="string"){const a=arguments[1]||{};return t({...a,type:x,description:arguments[0]})}}}var ie=V('<li class="svelte-76v4rr"><!></li>'),le=V('<div><ul class="svelte-76v4rr"></ul></div>');function de(x,t){ut(t,!1);const a=Bt(),i=()=>Ht(K,"$toasts",a);let z=F(t,"theme",8,"dark"),S=F(t,"placement",8,"bottom-right"),y=F(t,"type",8,"info"),c=F(t,"showProgress",8,!1),f=F(t,"duration",8,3e3),L=F(t,"width",8,"320px");const j=["bottom-right","bottom-left","top-right","top-left","top-center","bottom-center","center-center"],_={"bottom-right":400,"top-right":-400,"bottom-left":400,"top-left":-400,"bottom-center":400,"top-center":-400,"center-center":-800};ae(()=>{K.setDefaults({placement:S(),showProgress:c(),theme:z(),duration:f(),type:y()})}),Lt();var w=P(),C=R(w);ft(C,1,()=>j,Ct,(B,l)=>{var m=le(),p=o(m);ft(p,13,()=>i().filter(v=>v.placement===e(l)).reverse(),v=>v.uid,(v,h)=>{var k=ie(),g=o(k);T(g,()=>e(h).component,A=>{var O=P(),H=R(O);Yt(H,()=>e(h).component,(D,Z)=>{Z(D,{get data(){return e(h)}})}),n(A,O)},A=>{var O=P(),H=R(O);$(H,t,"default",{get data(){return e(h)}},null),n(A,O)}),r(k),$t(k,()=>Xt,null),St(2,k,()=>te,()=>({y:_[e(h).placement],duration:1e3})),St(1,k,()=>ee,()=>({duration:500})),n(v,k)}),r(p),r(m),tt(()=>{wt(m,`toast-container ${e(l)??""} svelte-76v4rr`),it(m,"style",`width: ${L()??""}`)}),n(B,m)}),n(x,w),mt()}var ce=q('<svg class="st-toast-icon svelte-brmuwn" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" aria-hidden="true"><path d="M10,1c-4.9,0-9,4.1-9,9s4.1,9,9,9s9-4,9-9S15,1,10,1z M8.7,13.5l-3.2-3.2l1-1l2.2,2.2l4.8-4.8l1,1L8.7,13.5z"></path><path fill="none" d="M8.7,13.5l-3.2-3.2l1-1l2.2,2.2l4.8-4.8l1,1L8.7,13.5z" data-icon-path="inner-path" opacity="0"></path></svg>'),ve=q('<svg class="st-toast-icon svelte-brmuwn" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 32 32" aria-hidden="true"><path d="M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Zm0,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,16,7Zm4,17.12H12V21.88h2.88V15.12H13V12.88h4.13v9H20Z"></path></svg>'),pe=q('<svg class="st-toast-icon svelte-brmuwn" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" aria-hidden="true"><path d="M10,1c-5,0-9,4-9,9s4,9,9,9s9-4,9-9S15,1,10,1z M13.5,14.5l-8-8l1-1l8,8L13.5,14.5z"></path><path d="M13.5,14.5l-8-8l1-1l8,8L13.5,14.5z" data-icon-path="inner-path" opacity="0"></path></svg>'),ue=q('<svg class="st-toast-icon svelte-brmuwn" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" aria-hidden="true"><path d="M10,1c-5,0-9,4-9,9s4,9,9,9s9-4,9-9S15,1,10,1z M9.2,5h1.5v7H9.2V5z M10,16c-0.6,0-1-0.4-1-1s0.4-1,1-1	s1,0.4,1,1S10.6,16,10,16z"></path><path d="M9.2,5h1.5v7H9.2V5z M10,16c-0.6,0-1-0.4-1-1s0.4-1,1-1s1,0.4,1,1S10.6,16,10,16z" data-icon-path="inner-path" opacity="0"></path></svg>'),me=q('<svg xmlns="http://www.w3.org/2000/svg" class="bx--toast-notification__close-icon svelte-brmuwn" width="20" height="20" viewBox="0 0 32 32" aria-hidden="true"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"></path></svg>'),ge=V('<div class="st-toast-header svelte-brmuwn"><!> <strong class="st-toast-title svelte-brmuwn"> </strong> <button data-notification-btn="" class="st-toast-close-btn svelte-brmuwn" type="button" aria-label="close"><!></button></div>'),he=q('<svg class="st-toast-icon svelte-brmuwn" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" aria-hidden="true"><path d="M10,1c-4.9,0-9,4.1-9,9s4.1,9,9,9s9-4,9-9S15,1,10,1z M8.7,13.5l-3.2-3.2l1-1l2.2,2.2l4.8-4.8l1,1L8.7,13.5z"></path><path fill="none" d="M8.7,13.5l-3.2-3.2l1-1l2.2,2.2l4.8-4.8l1,1L8.7,13.5z" data-icon-path="inner-path" opacity="0"></path></svg>'),fe=q('<svg class="st-toast-icon svelte-brmuwn" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 32 32" aria-hidden="true"><path d="M16,2A14,14,0,1,0,30,16,14,14,0,0,0,16,2Zm0,5a1.5,1.5,0,1,1-1.5,1.5A1.5,1.5,0,0,1,16,7Zm4,17.12H12V21.88h2.88V15.12H13V12.88h4.13v9H20Z"></path></svg>'),_e=q('<svg class="st-toast-icon svelte-brmuwn" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" aria-hidden="true"><path d="M10,1c-5,0-9,4-9,9s4,9,9,9s9-4,9-9S15,1,10,1z M13.5,14.5l-8-8l1-1l8,8L13.5,14.5z"></path><path d="M13.5,14.5l-8-8l1-1l8,8L13.5,14.5z" data-icon-path="inner-path" opacity="0"></path></svg>'),we=q('<svg class="st-toast-icon svelte-brmuwn" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" aria-hidden="true"><path d="M10,1c-5,0-9,4-9,9s4,9,9,9s9-4,9-9S15,1,10,1z M9.2,5h1.5v7H9.2V5z M10,16c-0.6,0-1-0.4-1-1s0.4-1,1-1	s1,0.4,1,1S10.6,16,10,16z"></path><path d="M9.2,5h1.5v7H9.2V5z M10,16c-0.6,0-1-0.4-1-1s0.4-1,1-1s1,0.4,1,1S10.6,16,10,16z" data-icon-path="inner-path" opacity="0"></path></svg>'),be=q('<svg xmlns="http://www.w3.org/2000/svg" class="bx--toast-notification__close-icon svelte-brmuwn" width="20" height="20" viewBox="0 0 32 32" aria-hidden="true"><path d="M24 9.4L22.6 8 16 14.6 9.4 8 8 9.4 14.6 16 8 22.6 9.4 24 16 17.4 22.6 24 24 22.6 17.4 16 24 9.4z"></path></svg>'),xe=V('<button data-notification-btn="" class="st-toast-close-btn svelte-brmuwn" type="button" aria-label="close"><!></button>'),ye=V('<div role="alert" aria-live="assertive" aria-atomic="true"><!> <div class="st-toast-body svelte-brmuwn"><!> <span class="st-toast-description svelte-brmuwn"> </span> <!> <div class="st-toast-extra"><!></div></div></div>');function ke(x,t){ut(t,!1);let a=F(t,"theme",8,"light"),i=F(t,"data",24,()=>({}));const z=B=>{B.stopPropagation(),i().remove(),typeof i().onRemove=="function"&&i().onRemove()},S=()=>{typeof i().onClick=="function"&&i().onClick()};Lt();var y=ye(),c=o(y);T(c,()=>i().title,B=>{var l=ge(),m=o(l);$(m,t,"icon",{},g=>{var A=P(),O=R(A);T(O,()=>i().type==="success",H=>{var D=ce();n(H,D)},H=>{var D=P(),Z=R(D);T(Z,()=>i().type==="info",E=>{var Q=ve();n(E,Q)},E=>{var Q=P(),et=R(Q);T(et,()=>i().type==="error",at=>{var rt=pe();n(at,rt)},at=>{var rt=ue();n(at,rt)},!0),n(E,Q)},!0),n(H,D)}),n(g,A)});var p=d(m,2),v=o(p,!0);r(p);var h=d(p,2),k=o(h);$(k,t,"close-icon",{},g=>{var A=me();n(g,A)}),r(h),r(l),tt(()=>pt(v,i().title)),lt("click",h,z),n(B,l)});var f=d(c,2),L=o(f);T(L,()=>!i().title,B=>{var l=P(),m=R(l);$(m,t,"icon",{},p=>{var v=P(),h=R(v);T(h,()=>i().type==="success",k=>{var g=he();n(k,g)},k=>{var g=P(),A=R(g);T(A,()=>i().type==="info",O=>{var H=fe();n(O,H)},O=>{var H=P(),D=R(H);T(D,()=>i().type==="error",Z=>{var E=_e();n(Z,E)},Z=>{var E=we();n(Z,E)},!0),n(O,H)},!0),n(k,g)}),n(p,v)}),n(B,l)});var j=d(L,2),_=o(j,!0);r(j);var w=d(j,2);T(w,()=>!i().title,B=>{var l=xe(),m=o(l);$(m,t,"close-icon",{},p=>{var v=be();n(p,v)}),r(l),lt("click",l,z),n(B,l)});var C=d(w,2),N=o(C);$(N,t,"extra",{},null),r(C),r(f),r(y),tt(()=>{wt(y,`st-toast bootstrap ${(i().theme||a())??""} ${(i().type||"info")??""} svelte-brmuwn`),It(f,"st-toast-no-title",!i().title),pt(_,i().description)}),lt("click",y,S),n(x,y),mt()}var Me=(x,t)=>t(x.target.value),ze=(x,t,a)=>b(t,U(e(t)===e(a).id?null:e(a).id)),Te=(x,t,a)=>t(e(a).id),Se=V('<i class="fa-solid fa-spinner animate-spin"></i>'),je=V('<i class="fa-solid fa-trash"></i>'),Ce=V('<i class="fa-solid fa-spinner animate-spin"></i>'),Be=V('<div class="m-2"><form><!></form> <div class="mt-4 flex flex-grow gap-4"><button type="button" class="flex-1 rounded-lg bg-red-300 p-2 px-5 font-medium transition duration-300 hover:bg-red-500 hover:text-white disabled:cursor-not-allowed dark:bg-red-500/75 dark:hover:bg-red-500 dark:hover:text-white"><!> Delete</button> <button type="submit" class="flex-1 rounded-lg bg-green-300 p-2 px-5 font-medium transition duration-300 hover:bg-green-500 hover:text-white disabled:cursor-not-allowed dark:bg-green-500/75 dark:hover:bg-green-500 dark:hover:text-white"><!> Save</button></div></div>'),He=V('<div class="rounded-xl bg-white p-4 shadow-sm dark:bg-slate-700"><span class="text-lg font-semibold"> </span> <p class="cursor-pointer select-none text-gray-500 transition duration-300 hover:text-blurple dark:text-slate-400 dark:hover:text-blurple"><i></i> <span class="text-sm"> </span></p> <!></div>'),Le=V('<i class="fa-solid fa-spinner animate-spin"></i>'),Oe=V('<div class="mb-8 text-center text-orange-600 dark:text-orange-400"><p><i class="fa-solid fa-triangle-exclamation"></i> <a href="https://discordtickets.app/configuration/tags" class="font-semibold hover:underline">Read the documentation</a> to avoid problems.</p></div> <h1 class="m-4 text-center text-4xl font-bold">Tags</h1> <!> <div class="m-2 mx-auto flex max-w-5xl flex-col-reverse gap-12 md:mt-8 lg:flex-row"><div class="w-full"><div class="grid grid-cols-1 gap-4"><div><input type="text" class="input form-input" placeholder="Search"></div> <!></div></div> <div class="w-full"><div class="rounded-xl bg-white p-4 shadow-sm dark:bg-slate-700"><h3 class="text-center text-xl font-bold">Create a tag</h3> <form class="my-4 text-lg"><div class="grid grid-cols-1 gap-2"><!> <button type="submit" class="mt-4 rounded-lg bg-green-300 p-2 px-5 font-medium transition duration-300 hover:bg-green-500 hover:text-white disabled:cursor-not-allowed dark:bg-green-500/75 dark:hover:bg-green-500 dark:hover:text-white"><!> Create</button></div></form></div></div></div> <!>',1);function da(x,t){ut(t,!0);const a=Bt(),z=`/api/admin/guilds/${Ht(Ft,"$page",a).params.guild}/tags`;let{tags:S}=t.data;G.tags=S;let y=Y(U(G.tags)),c=Y(!1),f=Y(null),L=Y(U({content:null,name:null,regex:null})),j=Y(null),_=Y("");const w=u=>{b(y,U(G.tags.filter(s=>{const M=new RegExp(u.replace(/(?=\W)/g,"\\"),"i");return M.test(s.name)||M.test(s.regex)||M.test(s.content)})))},C=async()=>{try{b(f,null),b(c,!0);const u={...e(L)},s=await fetch(z,{method:"POST",body:JSON.stringify(u),credentials:"include",headers:{"Content-Type":"application/json; charset=UTF-8"}}),M=await s.json();if(s.ok)G.tags.push(M),w(e(_)),b(L,U({content:null,name:null,regex:null})),b(c,!1),K.add({description:"Tag created",type:"success"});else throw M}catch(u){b(c,!1),b(f,U(u)),window.scroll({top:0,behavior:"smooth"}),K.add({description:"Tag creation failed",type:"error"})}},N=async u=>{try{b(f,null),b(c,!0);const s={...u},M=await fetch(`${z}/${s.id}`,{method:"PATCH",body:JSON.stringify(s),credentials:"include",headers:{"Content-Type":"application/json; charset=UTF-8"}}),I=await M.json();if(M.ok)b(c,!1),K.add({description:"Tag saved",type:"success"});else throw I}catch(s){b(c,!1),b(f,U(s)),window.scroll({top:0,behavior:"smooth"}),K.add({description:"Tag saving failed",type:"error"})}},B=async u=>{try{b(f,null),b(c,!0);const s=await fetch(`${z}/${u}`,{method:"DELETE"}),M=await s.json();if(console.log(M),s.ok){const I=G.tags.findIndex(st=>st.id===u);G.tags.splice(I,1),w(e(_)),b(c,!1),K.add({description:"Tag deleted",type:"success"})}else throw M}catch(s){b(c,!1),b(f,U(s)),window.scroll({top:0,behavior:"smooth"}),K.add({description:"Tag deletion failed",type:"error"})}};var l=Oe(),m=d(R(l),4);T(m,()=>e(f),u=>{Wt(u,{get error(){return e(f)}})});var p=d(m,2),v=o(p),h=o(v),k=o(h),g=o(k);_t(g),g.__input=[Me,w],r(k);var A=d(k,2);ft(A,17,()=>e(y),Ct,(u,s,M)=>{var I=He(),st=o(I),Ot=o(st,!0);r(st);var dt=d(st,2);dt.__click=[ze,j,s];var bt=o(dt),xt=d(bt,2),Vt=o(xt);r(xt),r(dt);var Rt=d(dt,2);T(Rt,()=>e(j)===e(s).id,At=>{var gt=Be(),X=o(gt),Dt=kt(()=>zt(()=>N(e(s)))),Et=o(X);jt(Et,{get tag(){return G.tags[M]},set tag(J){G.tags[M]=J}}),r(X);var yt=d(X,2),ot=o(yt);ot.__click=[Te,B,s];var Pt=o(ot);T(Pt,()=>e(c),J=>{var W=Se();n(J,W)},J=>{var W=je();n(J,W)}),ht(),r(ot);var nt=d(ot,2),qt=o(nt);T(qt,()=>e(c),J=>{var W=Ce();n(J,W)}),ht(),r(nt),r(yt),r(gt),tt(()=>{it(X,"id",e(s).id),it(X,"name",e(s).name),ot.disabled=e(c),it(nt,"for",e(s).id),it(nt,"form",e(s).id),nt.disabled=e(c)}),lt("submit",X,function(...J){var W;(W=e(Dt))==null||W.apply(this,J)}),n(At,gt)}),r(I),tt(()=>{pt(Ot,e(s).name),wt(bt,`fa-solid ${(e(j)===e(s).id?"fa-angle-up":"fa-angle-down")??""} float-right text-xl`),pt(Vt,`Click to ${(e(j)===e(s).id?"collapse":"expand")??""}`)}),n(u,I)}),r(h),r(v);var O=d(v,2),H=o(O),D=d(o(H),2),Z=kt(()=>zt(()=>C())),E=o(D),Q=o(E);jt(Q,{get tag(){return e(L)},set tag(u){b(L,U(u))}});var et=d(Q,2),at=o(et);T(at,()=>e(c),u=>{var s=Le();n(u,s)}),ht(),r(et),r(E),r(D),r(H),r(O),r(p);var rt=d(p,2);de(rt,{duration:3e3,get theme(){return t.data.theme},children:(s,M)=>{let I=()=>M==null?void 0:M().data;ke(s,{get data(){return I()}})},$$slots:{default:!0}}),tt(()=>et.disabled=e(c)),vt(g,()=>e(_),u=>b(_,u)),lt("submit",D,function(...u){var s;(s=e(Z))==null||s.apply(this,u)}),n(x,l),mt()}Ut(["input","click"]);export{da as component,la as universal};
